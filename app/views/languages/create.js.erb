let $input = $(`div#languages`).children('input.language:first'),
    $tag = $("<div />"),
    $a = $(`<a href='#' class="language"/>`),
    $span = $("<span />"),
    $appendHere = $(`.tagHere.languages:first`);

$tag.addClass('tag language');

$('<i class="fa fa-times" aria-hidden="true"></i>').appendTo($a);

$span.text("<%= @language.name %>");

$a.appendTo($tag);
$span.appendTo($tag);

for (var i = 0; i < 3; i++) {
	$(`<span class="glyphicon glyphicon-star" style="color: gold;"></span>`).appendTo($tag);
}

for (var i = 0; i < 4; i++) {
	$(`<span class="glyphicon glyphicon-star-empty"></span>`).appendTo($tag);
}

$tag.appendTo($appendHere);

$($input).val('');
$($input).focus();

$a.bind('click', function(e) {
  e.preventDefault();
  $(this).unbind('click');
	
	let $DIV = $tag,
    $CVID = $(`div.moncv:first`).attr('id'),
		$ID = "<%=  @language.id %>";

	removeLanguage($DIV, $CVID, $ID);
});


function removeLanguage(div, cv_id, id) {
    let AUTH_TOKEN = $(`input[name="authenticity_token"]`).attr('value');

    div.fadeOut('slow', function() {
      div.remove();
    });

    $.ajax({
        url: `/languages/${id}`,
        type: 'DELETE',
        data: {
            authenticity_token: AUTH_TOKEN,
            cv_id: cv_id,
            id: id
        },
    });
}